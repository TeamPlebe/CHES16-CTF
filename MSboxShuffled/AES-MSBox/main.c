/*
 * CHES-CTF.c
 *
 * Created: 15/06/2016 15:41:21
 * Author : labo-ceaci
 */ 

#include <avr/io.h>
#include <stdio.h>
#include <string.h>
#include "aes-challenge.h"


int main(void)
{
	uint8_t key[16] = {0xe0,0x9d,0x23,0x67,0x3f,0x0c,0x94,0xa5,0x00,0x81,0x16,0xdb,0xd9,0xfc,0x3b,0x47};//0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};
	uint8_t pt[16] = {0x6e,0x98,0x1a,0x48,0x1b,0x1b,0xbd,0x3d,0xbd,0x27,0xa9,0x09,0x9e,0x2f,0x49,0x48};//0x6b,0xc1,0xbe,0xe2,0x2e,0x40,0x9f,0x96,0xe9,0x3d,0x7e,0x11,0x73,0x93,0x17,0x2a};
	uint8_t ct[16] = {0x59,0xd5,0xa1,0x3e,0x17,0xff,0x2e,0x74,0xd0,0x3c,0x9e,0x5a,0x27,0x67,0xea,0x49};//0x3a,0xd7,0x7b,0xb4,0x0d,0x7a,0x36,0x60,0xa8,0x9e,0xca,0xf3,0x24,0x66,0xef,0x97};
	uint8_t tst[16];
	
    aes_indep_init();
	for(uint8_t i=0;i<10;i++)
	{
		memcpy(tst,pt,16);
		aes_indep_key(key);
		aes_indep_enc(tst);
		
		if(memcmp(tst,ct,16))
		{
			printf("error\n");
		}
	}
	
}

